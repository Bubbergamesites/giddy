<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Giddy! super propane madness!</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body {
    margin: 0;
    background: #87ceeb;
    overflow: hidden;
    font-family: Arial, sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
  }
  canvas {
    display: none; /* Hidden until game starts */
    background: linear-gradient(#7ec8ff, #e8f7ff);
    border: 2px solid #000;
  }
  #start-overlay {
    position: absolute;
    text-align: center;
    background: rgba(255, 255, 255, 0.9);
    padding: 30px;
    border-radius: 15px;
    box-shadow: 0 0 20px rgba(0,0,0,0.3);
    z-index: 10;
  }
  button {
    padding: 15px 30px;
    font-size: 20px;
    cursor: pointer;
    background: #ff4d6d;
    color: white;
    border: none;
    border-radius: 5px;
    font-weight: bold;
  }
</style>
</head>
<body>

<div id="start-overlay">
  <h1>Giddy! Super Propane Madness</h1>
  <p>Click to start and play music</p>
  <button id="start-btn">START GAME</button>
</div>

<canvas id="game" width="1000" height="500"></canvas>

<audio id="bg-music" loop>
  <source src="https://github.com/Bubbergamesites/giddy/raw/refs/heads/main/Saari%20Duniya%20Jalaa%20Denge.mp3" type="audio/mpeg">
</audio>

<script>
/* =====================
   BASIC SETUP
===================== */
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const startOverlay = document.getElementById("start-overlay");
const startBtn = document.getElementById("start-btn");
const bgMusic = document.getElementById("bg-music");

let score = 0;
let hearts = 5;
let speed = 3.2;
let items = [];
let gameOver = false;
let paused = false;
let gameStarted = false;

/* =====================
   LOAD SPRITES
===================== */
const heroImg = new Image();
heroImg.src = "https://raw.githubusercontent.com/Bubbergamesites/giddy/refs/heads/main/4683813990300486552.PNG";

const propaneImg = new Image();
propaneImg.src = "https://raw.githubusercontent.com/Bubbergamesites/giddy/refs/heads/main/4339546925217431725.PNG";

/* =====================
   HERO
===================== */
const hero = {
  x: 120,
  y: 180,
  w: 120,
  h: 120,
  speed: 5
};

/* =====================
   INPUT & START
===================== */
startBtn.addEventListener("click", () => {
  startOverlay.style.display = "none";
  canvas.style.display = "block";
  gameStarted = true;
  
  // Play Music
  bgMusic.volume = 0.5;
  bgMusic.play();
  
  update();
});

const keys = {};
addEventListener("keydown", e => {
  if (e.code === "Space") {
    paused = !paused;
    e.preventDefault();
  }
  keys[e.key] = true;
});
addEventListener("keyup", e => keys[e.key] = false);

/* =====================
   ITEM SPAWNING
===================== */
function spawnItem() {
  if (paused || gameOver || !gameStarted) return;

  const r = Math.random();
  let type = r < 0.4 ? "propane" : r < 0.8 ? "food" : "star";

  items.push({
    type,
    x: canvas.width + 50,
    y: 60 + Math.random() * 300,
    collected: false
  });
}
setInterval(spawnItem, 1000);

/* =====================
   DRAW FUNCTIONS
===================== */
function drawHero() {
  ctx.drawImage(heroImg, hero.x, hero.y, hero.w, hero.h);
}

function drawItem(item) {
  if (item.type === "propane") {
    ctx.drawImage(propaneImg, item.x, item.y, 70, 40);
  } else if (item.type === "food") {
    ctx.fillStyle = "#c68642";
    ctx.beginPath();
    ctx.arc(item.x + 20, item.y + 20, 20, 0, Math.PI * 2);
    ctx.fill();
    ctx.fillStyle = "#fff";
    ctx.fillRect(item.x + 8, item.y + 14, 24, 6);
  } else {
    ctx.fillStyle = "gold";
    ctx.beginPath();
    for (let i = 0; i < 5; i++) {
      ctx.lineTo(
        item.x + Math.cos((18 + i * 72) * Math.PI / 180) * 18,
        item.y - Math.sin((18 + i * 72) * Math.PI / 180) * 18
      );
      ctx.lineTo(
        item.x + Math.cos((54 + i * 72) * Math.PI / 180) * 8,
        item.y - Math.sin((54 + i * 72) * Math.PI / 180) * 8
      );
    }
    ctx.closePath();
    ctx.fill();
  }
}

/* =====================
   GAME LOOP
===================== */
function update() {
  if (!gameStarted) return;
  
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  if (!paused && !gameOver) {
    // Movement
    if (keys["ArrowUp"] && hero.y > 20) hero.y -= hero.speed;
    if (keys["ArrowDown"] && hero.y < canvas.height - hero.h - 20)
      hero.y += hero.speed;

    items.forEach(item => {
      item.x -= speed;

      const aligned =
        Math.abs(item.y - hero.y) < 40 &&
        item.x < hero.x + hero.w &&
        item.x + 40 > hero.x;

      if (!item.collected && aligned) {
        score += item.type === "star" ? 50 : 10;
        item.collected = true;
      }

      if (item.x < -60 && !item.collected && item.type !== "star") {
        hearts--;
        item.collected = true;
      }
    });

    items = items.filter(i => !i.collected);
  }

  drawHero();
  items.forEach(drawItem);

  // HUD
  ctx.fillStyle = "#000";
  ctx.font = "24px Arial";
  ctx.fillText("Score: " + score, 15, 35);
  ctx.fillText("Hearts: " + "❤️".repeat(hearts), 15, 70);

  if (paused) {
    ctx.fillStyle = "rgba(0,0,0,0.6)";
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    ctx.fillStyle = "#fff";
    ctx.font = "40px Arial";
    ctx.fillText("PAUSED", canvas.width / 2 - 80, canvas.height / 2);
  }

  if (hearts <= 0) {
    gameOver = true;
    bgMusic.pause(); // Stop music on game over
    ctx.fillStyle = "red";
    ctx.font = "60px Arial";
    ctx.fillText("GAME OVER", canvas.width / 2 - 180, canvas.height / 2);
  } else {
    requestAnimationFrame(update);
  }
}
</script>
</body>
</html>
